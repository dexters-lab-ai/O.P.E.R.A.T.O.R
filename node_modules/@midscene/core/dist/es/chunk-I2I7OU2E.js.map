{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["../../src/env.ts"],"sourcesContent":["// config keys\nexport const MIDSCENE_OPENAI_INIT_CONFIG_JSON =\n  'MIDSCENE_OPENAI_INIT_CONFIG_JSON';\nexport const MIDSCENE_MODEL_NAME = 'MIDSCENE_MODEL_NAME';\nexport const MIDSCENE_LANGSMITH_DEBUG = 'MIDSCENE_LANGSMITH_DEBUG';\nexport const MIDSCENE_DEBUG_AI_PROFILE = 'MIDSCENE_DEBUG_AI_PROFILE';\nexport const MIDSCENE_DEBUG_AI_RESPONSE = 'MIDSCENE_DEBUG_AI_RESPONSE';\nexport const MIDSCENE_DANGEROUSLY_PRINT_ALL_CONFIG =\n  'MIDSCENE_DANGEROUSLY_PRINT_ALL_CONFIG';\nexport const MIDSCENE_DEBUG_MODE = 'MIDSCENE_DEBUG_MODE';\nexport const MIDSCENE_OPENAI_SOCKS_PROXY = 'MIDSCENE_OPENAI_SOCKS_PROXY';\nexport const OPENAI_API_KEY = 'OPENAI_API_KEY';\nexport const OPENAI_BASE_URL = 'OPENAI_BASE_URL';\nexport const OPENAI_MAX_TOKENS = 'OPENAI_MAX_TOKENS';\n\nexport const MIDSCENE_CACHE = 'MIDSCENE_CACHE';\nexport const MIDSCENE_USE_VLM_UI_TARS = 'MIDSCENE_USE_VLM_UI_TARS';\nexport const MIDSCENE_USE_QWEN_VL = 'MIDSCENE_USE_QWEN_VL';\nexport const MIDSCENE_USE_DOUBAO_VISION = 'MIDSCENE_USE_DOUBAO_VISION';\nexport const MIDSCENE_USE_VL_MODEL = 'MIDSCENE_USE_VL_MODEL';\nexport const MATCH_BY_POSITION = 'MATCH_BY_POSITION';\nexport const MIDSCENE_API_TYPE = 'MIDSCENE-API-TYPE';\nexport const MIDSCENE_REPORT_TAG_NAME = 'MIDSCENE_REPORT_TAG_NAME';\n\nexport const MIDSCENE_USE_AZURE_OPENAI = 'MIDSCENE_USE_AZURE_OPENAI';\nexport const MIDSCENE_AZURE_OPENAI_SCOPE = 'MIDSCENE_AZURE_OPENAI_SCOPE';\nexport const MIDSCENE_AZURE_OPENAI_INIT_CONFIG_JSON =\n  'MIDSCENE_AZURE_OPENAI_INIT_CONFIG_JSON';\n\nexport const AZURE_OPENAI_ENDPOINT = 'AZURE_OPENAI_ENDPOINT';\nexport const AZURE_OPENAI_KEY = 'AZURE_OPENAI_KEY';\nexport const AZURE_OPENAI_API_VERSION = 'AZURE_OPENAI_API_VERSION';\nexport const AZURE_OPENAI_DEPLOYMENT = 'AZURE_OPENAI_DEPLOYMENT';\n\nexport const MIDSCENE_USE_ANTHROPIC_SDK = 'MIDSCENE_USE_ANTHROPIC_SDK';\nexport const ANTHROPIC_API_KEY = 'ANTHROPIC_API_KEY';\n\n// @deprecated\nexport const OPENAI_USE_AZURE = 'OPENAI_USE_AZURE';\n\nconst allConfigFromEnv = () => {\n  return {\n    [MIDSCENE_OPENAI_INIT_CONFIG_JSON]:\n      process.env[MIDSCENE_OPENAI_INIT_CONFIG_JSON] || undefined,\n    [MIDSCENE_MODEL_NAME]: process.env[MIDSCENE_MODEL_NAME] || undefined,\n    [MIDSCENE_DEBUG_MODE]: process.env[MIDSCENE_DEBUG_MODE] || undefined,\n    [MIDSCENE_LANGSMITH_DEBUG]:\n      process.env[MIDSCENE_LANGSMITH_DEBUG] || undefined,\n    [MIDSCENE_DEBUG_AI_PROFILE]:\n      process.env[MIDSCENE_DEBUG_AI_PROFILE] || undefined,\n    [MIDSCENE_DEBUG_AI_RESPONSE]:\n      process.env[MIDSCENE_DEBUG_AI_RESPONSE] || undefined,\n    [MIDSCENE_DANGEROUSLY_PRINT_ALL_CONFIG]:\n      process.env[MIDSCENE_DANGEROUSLY_PRINT_ALL_CONFIG] || undefined,\n    [OPENAI_API_KEY]: process.env[OPENAI_API_KEY] || undefined,\n    [OPENAI_BASE_URL]: process.env[OPENAI_BASE_URL] || undefined,\n    [OPENAI_MAX_TOKENS]: process.env[OPENAI_MAX_TOKENS] || undefined,\n    [OPENAI_USE_AZURE]: process.env[OPENAI_USE_AZURE] || undefined,\n    [MIDSCENE_CACHE]: process.env[MIDSCENE_CACHE] || undefined,\n    [MATCH_BY_POSITION]: process.env[MATCH_BY_POSITION] || undefined,\n    [MIDSCENE_REPORT_TAG_NAME]:\n      process.env[MIDSCENE_REPORT_TAG_NAME] || undefined,\n    [MIDSCENE_OPENAI_SOCKS_PROXY]:\n      process.env[MIDSCENE_OPENAI_SOCKS_PROXY] || undefined,\n    [MIDSCENE_USE_AZURE_OPENAI]:\n      process.env[MIDSCENE_USE_AZURE_OPENAI] || undefined,\n    [MIDSCENE_AZURE_OPENAI_SCOPE]:\n      process.env[MIDSCENE_AZURE_OPENAI_SCOPE] || undefined,\n    [MIDSCENE_AZURE_OPENAI_INIT_CONFIG_JSON]:\n      process.env[MIDSCENE_AZURE_OPENAI_INIT_CONFIG_JSON] || undefined,\n    [MIDSCENE_USE_ANTHROPIC_SDK]:\n      process.env[MIDSCENE_USE_ANTHROPIC_SDK] || undefined,\n    [MIDSCENE_USE_VLM_UI_TARS]:\n      process.env[MIDSCENE_USE_VLM_UI_TARS] || undefined,\n    [MIDSCENE_USE_QWEN_VL]: process.env[MIDSCENE_USE_QWEN_VL] || undefined,\n    [MIDSCENE_USE_DOUBAO_VISION]:\n      process.env[MIDSCENE_USE_DOUBAO_VISION] || undefined,\n    [MIDSCENE_USE_VL_MODEL]: process.env[MIDSCENE_USE_VL_MODEL] || undefined,\n    [ANTHROPIC_API_KEY]: process.env[ANTHROPIC_API_KEY] || undefined,\n    [AZURE_OPENAI_ENDPOINT]: process.env[AZURE_OPENAI_ENDPOINT] || undefined,\n    [AZURE_OPENAI_KEY]: process.env[AZURE_OPENAI_KEY] || undefined,\n    [AZURE_OPENAI_API_VERSION]:\n      process.env[AZURE_OPENAI_API_VERSION] || undefined,\n    [AZURE_OPENAI_DEPLOYMENT]:\n      process.env[AZURE_OPENAI_DEPLOYMENT] || undefined,\n  };\n};\n\nlet userConfig: Partial<ReturnType<typeof allConfigFromEnv>> = {};\n\nexport const vlLocateMode = ():\n  | 'qwen-vl'\n  | 'doubao-vision'\n  | 'vl-model'\n  | false => {\n  if (\n    getAIConfigInBoolean(MIDSCENE_USE_DOUBAO_VISION) &&\n    getAIConfigInBoolean(MIDSCENE_USE_QWEN_VL)\n  ) {\n    throw new Error(\n      'MIDSCENE_USE_DOUBAO_VISION and MIDSCENE_USE_QWEN_VL cannot be true at the same time',\n    );\n  }\n\n  if (getAIConfigInBoolean(MIDSCENE_USE_QWEN_VL)) {\n    return 'qwen-vl';\n  }\n\n  if (getAIConfigInBoolean(MIDSCENE_USE_DOUBAO_VISION)) {\n    return 'doubao-vision';\n  }\n\n  if (getAIConfigInBoolean(MIDSCENE_USE_VL_MODEL)) {\n    return 'vl-model';\n  }\n\n  return false;\n};\n\nexport const getAIConfig = (\n  configKey: keyof typeof userConfig,\n): string | undefined => {\n  if (configKey === MATCH_BY_POSITION) {\n    throw new Error(\n      'MATCH_BY_POSITION is deprecated, use MIDSCENE_USE_VL_MODEL instead',\n    );\n  }\n\n  if (typeof userConfig[configKey] !== 'undefined') {\n    if (typeof userConfig[configKey] === 'string') {\n      return userConfig[configKey]?.trim();\n    }\n    return userConfig[configKey];\n  }\n  return allConfigFromEnv()[configKey]?.trim();\n};\n\nexport const getAIConfigInBoolean = (configKey: keyof typeof userConfig) => {\n  const config = getAIConfig(configKey) || '';\n  return /^(true|1)$/i.test(config);\n};\n\nexport const getAIConfigInJson = (configKey: keyof typeof userConfig) => {\n  const config = getAIConfig(configKey);\n  try {\n    return config ? JSON.parse(config) : undefined;\n  } catch (error: any) {\n    throw new Error(\n      `Failed to parse json config: ${configKey}. ${error.message}`,\n      {\n        cause: error,\n      },\n    );\n  }\n};\n\nexport const allAIConfig = () => {\n  return { ...allConfigFromEnv(), ...userConfig };\n};\n\nexport const overrideAIConfig = (\n  newConfig: Partial<ReturnType<typeof allConfigFromEnv>>,\n  extendMode?: boolean,\n) => {\n  for (const key in newConfig) {\n    if (typeof key !== 'string') {\n      throw new Error(`Failed to override AI config, invalid key: ${key}`);\n    }\n    if (typeof newConfig[key as keyof typeof newConfig] === 'object') {\n      throw new Error(\n        `Failed to override AI config, invalid value for key: ${key}, value: ${newConfig[key as keyof typeof newConfig]}`,\n      );\n    }\n  }\n\n  userConfig = extendMode ? { ...userConfig, ...newConfig } : { ...newConfig };\n};\n"]}